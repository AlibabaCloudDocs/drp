# 添加 Zerg Service 类型的节点

Zerg-Service 是在线服务类型的算法，在线服务指的是一类“常驻”守护型服务， 它的使用方式是通过某种远程过程调用 RPC （Remote Procedure Call）来提供服务。

-   已添加 Zerg-Service 节点所要使用的数据模型。
-   推荐您预先准备好算法文件、脚本等。

Zerg-Service 运行于 Zerg Service 类型的云计算资源之上，可处理 MaxCompute、ApsaraDB for RDS、Hive 和 Datahub Service 等类型的数据源。

以下为各种在线服务的 RPC 方式：

-   **HSF** \> **TCP+Hessian**
-   **JAX-RS** \> **HTTP**
-   **Spring Remoting** \> **HTTP+Hessian**

RPC 的实现方式对于使用在线服务的用户透明，用户只需要对接 Zerg-Client 即可完成服务的调用。

1.  登录[数据资源平台控制台](https://dataq.console.aliyun.com)。

2.  在页面左上角单击**![菜单](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/6504337061/p188771.png)**按钮，选择**研发工作台** \> **资产加工** \> **![数据建模](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/7366900161/p208211.png)**，进入数据建模页面。

3.  单击左侧导航栏**场景加工** \> **公共节点** \> **添加节点**。

4.  在弹出的对话框中设置基本信息。

    |配置项|说明|
    |---|--|
    |**节点 Code**|节点的唯一标识，由用户自定义，同一个工作区内不可重复。|
    |**节点名称**|节点的名称。|
    |**服务类型**|**服务类型**与**计算资源类型**有内在关联关系，**在线服务** 类型的节点需要设置为**Zerg Service**。|
    |**计算资源类型**|
    |**作业类型**|包括：代码包和自定义镜像。|
    |**节点描述**|节点的描述性信息，方便用户理解和查找。|
    |**节点类目**|节点的类别，由用户自定义。下拉列表中会显示当前已定义的类目，如果无法满足您的要求，您可单击下拉列表中的**添加新类目**来创建 。|

5.  完成基本信息配置后，单击**下一步**，配置**算法资源**。

    |作业类型|配置项|说明|
    |----|---|--|
    |**代码包**|**GPU**|选中**使用 GPU** 时，可使用 GPU 对该 Zerg-Service 算法做计算。 后续在场景中添加该 Zerg-Service 计算节点时，您可在**运行属性**中设置**单实例 GPU 卡数**。 |
    |**模型**|选中**使用模型**：把模型管理的服务地址透传到算法启动参数，节点内部实现时即可调用对应的 Java 或 Python 版本的模型管理 SDK 来操作模型列表中的模型。|
    |**开发语言**|当前支持 **Java** 和 **Python** 两种语言，支持的版本如下：     -   **Java**：**Java 7** 和 **Java 8** 。
    -   **Python**：**Python 2.7** 和 **Python 3.6** 。
您需要根据运行节点的实际环境来选择**开发语言**和**开发语言版本**。 |
    |**开发语言版本**|
    |**服务开发规范**|推荐使用 **Zerg 2.0** 规范。|
    |**调用路径**（Python 语言参数）|当**开发语言**为 **Python** 时，需要根据实际情况设置调用算法文件的路径。 |
    |**算法文件**|支持导入本地资源文件，必须是单个的 .zip 包。|
    |**自定义镜像**|**GPU**|选中**使用 GPU** 时，可使用 GPU 对该 Zerg Service 算法做计算。 后续在场景中添加该 Zerg Service 节点节点时，您可在**运行属性**中设置**单实例 GPU 卡数**。 |
    |**模型**|选中**使用模型**：把模型管理的服务地址透传到算法启动参数，算法内部实现时即可调用对应的 Java 或 Python 版本的模型管理 SDK 来操作模型列表中的模型。|
    |**镜像名称**|zerg/image格式。|
    |**镜像版本号**|输入版本号。|
    |**健康检查方式**|HTTP健康检查默认请求/health, 返回码200表示成功。|
    |**服务端口**|输入服务端口号，镜像服务对外透出的端口。|

6.  完成**算法资源**配置后，单击**下一步**，在**API 配置**定义 API 的入参和返回值的数据格式。

    会自动从上传的算法文件中解析出 API，您只需要根据实际需要定义 API 的入参和返回值的数据格式即可。

7.  完成**API 配置**配置后，单击**下一步**，配置**节点输入**。

    如果节点文件和脚本中有要求输入变量，则单击**添加输入数据**，配置输入变量。

    |配置项|说明|
    |---|--|
    |**输入变量**|输入数据的名称，用户自定义。|
    |**数据格式**|输入数据的数据格式，由数据模型定义，在下拉列表中选择。|
    |**数据源类型**|输入数据的数据源类型，在下拉列表中选择，**Zerg-Standalone** 类型的算法支持 **MaxCompute**、**ApsaraDB for RDS**、**Datahub Service**、**Hive** 等类型的输入变量。|

8.  完成**节点输入**配置后，单击**下一步**，配置**节点输出**。

    如果节点脚本中有要求输出变量，则单击**添加输出数据**，配置输出变量。

    |配置项|说明|
    |---|--|
    |**输出变量**|输出变量的名称，用户自定义。|
    |**数据格式**|输出变量的数据格式，由数据模型定义，在下拉列表中选择。|
    |**数据源类型**|输入数据的数据源类型，在下拉列表中选择，**Zerg-Standalone** 类型的算法支持 **MaxCompute**、**ApsaraDB for RDS**、**Datahub Service**、**Hive** 等类型的输入变量。|

9.  完成**节点输出**配置后，单击**下一步**，配置**节点参数**。

    如果需要设置节点的全局控制参数，则单击**添加参数**，配置节点参数。

    |配置项|说明|
    |---|--|
    |**参数变量**|节点参数的名称，用户自定义。|
    |**值类型**|节点参数的值类型，目前支持的格式包括 **STRING**、**BOOLEAN**、**LONG**、**DOUBLE** 和 **DATE**，您可根据实际需要选择。|
    |**必填**|设置**节点参数**在节点的**运行属性**中是否为节点的必填参数。|
    |**默认值**|节点参数的默认值。|
    |**参数说明**|节点参数的描述，方便用户理解。|
    |**更多配置**|单击操作下的**![](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/3080749951/p44827.png)**，在对话框中，根据算法类型对最大长度、枚举、参数验证、JSON验证进行配置，在弹出的对话框中设置更多的配置项。 **值类型**不同，更多配置中的可配置项也不同，以 **STRING**类型的值为例，其可配置项如下图所示。 |

    ![string类型的定义](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/1434430161/p209106.png)

10. 完成上述参数配置后，单击**确定**，创建节点完成。


