# 新建测试场景

场景用于编排节点流程，只能在测试场景中创建。测试场景用于开发和测试节点流程。在测试环境中创建场景完成后，您需要在场景中搭建自己的节点流程并部署运行。

-   您已经添加节点，详见[添加 MaxCompute 类型的节点]()。
-   您已添加相关的云计算资源。

节点流程定义了一段处理逻辑，通过有向无环图 DAG（Directed Acyclic Graph）描述。节点流程中所有节点的输入、输出数据都是具体的数据表/文件/数据流，以下以MaxCompute节点搭建流程为例：

**说明：** 在搭建节点流程的过程中，如果上游节点和下游节点需要连线（即上游节点的输出数据要作为下游节点的输入数据），则要求上游节点的输出数据与下游节点的输入数据的数据格式必须一致。

1.  登录[数据资源平台控制台](https://dataq.console.aliyun.com)。

2.  在页面左上角单击**![菜单](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/6504337061/p188771.png)**按钮，选择**研发工作台** \> **资产加工** \> **![数据建模](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/7366900161/p208211.png)**，进入数据建模页面。

3.  单击左侧导航栏**场景加工** \> **测试场景** \> **![进入](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/6504337061/p188815.png)** \> **新建测试场景**。

4.  弹出**创建测试场景**页面，填写场景名称和code，单击**确定**，进入场景编排页面。

    ![流程编排区域](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/8207060161/p209451.png)

    |区域|说明|
    |--|--|
    |区域1|测试场景的名称。|
    |区域2|算法节点区域导航栏：     -   **我的节点**：以当前登录账号创建的节点。
    -   **系统节点**：
        -   **输入节点**：节点流程起始时定义输入数据源。
        -   **数据传输节点**：在两个算法节点间传输与同步数据，支持不同计算资源的数据转换。
        -   **节点组**：对依赖相同计算资源的算法节点进行组合，方便您管理算法节点。节点组中的算法节点在部署和运行时均被打包在一起进行调度。
        -   **依赖节点**：可设置节点自定义节点依赖或场景依赖的节点。
    -   **公共节点**：在公共节点管理界面中添加的节点。 |
    |区域3|场景画布的工具栏，支持保存、场景设置、测试环境部署、离线算法运行、场景上线、进入运维中心等功能。|
    |区域4|场景画布，是节点流程的搭建区域。在搭建节点流程时，您可拖拽算法节点到场景画布并设置参数，然后在节点节点间根据数据流向进行连线。|
    |区域5|场景和节点的属性设置区域。|

5.  根据实际需要添加系统节点和SQL节点。

    以下是添加节点的示例操作。

    1.  单击左侧**系统节点** \> **输入数据**节点拖到画布上，选中节点，输入对应信息。

    2.  单击画布上添加的**输入数据节点**，单击页面右侧**运行属性**，选择测试和线上云计算资源，并输入**测试配置**和**线上配置**的表名。

        新建输入数据节点配置：

        |配置项|说明|
        |---|--|
        |输入数据节点名称|自定义|
        |测试/线上云计算资源|根据客户定义选择，测试和线上场景不能相同|
        |测试/线上配置表名|根据客户需求自定义|

    3.  把左侧“Maxcompute”算法下拖入新建的节点到画布，并进行连线，连线过程中设置上下游节点连接详情，出的输出code-数据类型和入的输入code-数据类型一致连线如下图：

        ![连线](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/8857900161/p208831.png)

        ![连线效果](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/8857900161/p208828.png)

    4.  单击画布上添加的**自定义数据节点**，单击页面右侧**节点属性**，选择节点版本为**正式版**，单击**参数变量**，单击节点输出下的**![修改输出](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/9857900161/p208482.png)，**勾选**修改输出**，选择测试资源，输入输出表名，单击**线上资源**，勾选**配置输出表**，输入输出表名，单击**返回**。单击页面**运行属性**，选择测试和线上云计算资源、并单击**![开启](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/8207060161/p209503.png)**可设置定时调度。

        公共节点配置：

        |配置项|说明|
        |---|--|
        |测试/线上云计算资源|根据客户定义选择，测试和线上场景不能相同。|
        |测试/线上配置输出表名|数据的输出表。|
        |定时调度|定时调度只在线上场景生效。包含以下配置        -   依赖本节点上一周期调度：可勾选。
        -   生成实例方式：T+1次日生成和发布后即时生成。
        -   生效日期：自定义。
        -   调度周期：支持月、周、天、小时和分钟。
        -   具体时间：客户自定义。 |

    5.  单击**![保存](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/9857900161/p208484.png)**按钮后单击**![部署](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/9857900161/p208486.png)**，对测试场景进行部署，等待部署成功。

        **说明：** 如果场景部署或运行失败，您可将鼠标指针指向状态后并单击后面的**查看日志**，通过部署日志定位失败原因。

    6.  部署成功后，单击**![运行](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/9561429061/p205866.png)**进行离线节点运行，弹出**设置业务日期**，单击**确定**，等待运行成功。

        **说明：** 如果场景运行失败，您可将鼠标指针指向状态并单击后面的**查看日志**，通过运行日志定位失败原因。

6.  单击左侧导航栏**场景加工** \> **测试场景** \> **![列表](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/8207060161/p210355.png)**，可查看新建的场景。


