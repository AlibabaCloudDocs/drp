# 添加 MaxCompute 类型的节点

MaxCompute 节点是离线节点，运行于 MaxCompute 类型的云计算资源之上，可处理 MaxCompute 类型的数据源。

-   已添加与 MaxCompute 节点相关的数据模型。
-   推荐您预先准备好算法文件、脚本等。

本节以添加SQL和MR或GRAPH类型的 MaxCompute 节点为例进行介绍。

## 添加节点通过SQL作业类型

1.  登录[数据资源平台控制台](https://dataq.console.aliyun.com)。

2.  在页面左上角单击**![菜单](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/6504337061/p188771.png)**按钮，选择**研发工作台** \> **资产加工** \> **![数据建模](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/7366900161/p208211.png)**，进入数据建模页面。

3.  单击左侧导航栏**场景加工** \> **公共节点** \> **添加节点**。

4.  弹出**添加节点**页面，填写节点名称和code，服务类型选择为“离线服务”、计算资源类型为“MaxCompute”，作业类型为“SQL"，单击**下一步**。

    |配置项|说明|
    |---|--|
    |**节点Code**|节点的唯一标识，由用户自定义，同一个工作组必须是唯一的，不可重复。|
    |**节点名称**|节点的名称。|
    |**服务类型**|**服务类型**与**计算资源类型**有内在关联关系。**MaxCompute** 类型的节点需要设置为**离线服务**和 **MaxCompute**。|
    |**计算资源类型**|
    |**作业类型**|包括SQL和MR/GRAPH，选择SQL。**说明：** 如果作业类型选择SQL，则在SQL编译器里创建节点。 |
    |**节点描述**|节点的描述性信息，方便用户理解和查找。|
    |**节点类目**|节点的类别，由用户自定义。下拉列表中会显示当前已定义的类目，如果无法满足您的要求，您可单击下拉列表中的**添加新类目**来创建 。|

5.  弹出编辑页面进行配置。

    1.  输入SQL语句，单击页面右侧**运行属性**，选择测试资源。

    2.  节点输入：单击页面右侧**输入输出** \> **添加输入信息**，选择节点输入变量和数据模型，数据源类型为“Maxcompute”，在单击页面**![添加](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/8561429061/p205624.png)**。

    3.  节点输出：单击页面右侧**添加输出信息**，选择节点输出变量和数据模型，数据源类型为“Maxcompute”。

        节点输入输出信息配置：

        |配置项|说明|
        |---|--|
        |添加输入/输出信息|输入输出信息需要通过解析代码生成，或手动添加，解析通过单击页面**![解析](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/6824430161/p208903.png)**实现。|

    4.  单击左上角**![保存](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/8561429061/p205637.png)**按钮，单击**![运行](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/9561429061/p205638.png)**按钮，出现运行参数页面，输入默认值，单击**确定**，查看运行日志。

        节点运行参数信息配置：

        |配置项|说明|
        |---|--|
        |运行参数|通过解析代码生成，填入默认值。|

6.  单击**![返回](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/9561429061/p205667.png)**，页面返回到**节点管理**页面，查看新建的节点。


## 添加节点通过MR/GRAPH作业类型

1.  登录[数据资源平台控制台](https://dataq.console.aliyun.com)。

2.  在页面左上角单击**![菜单](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/6504337061/p188771.png)**按钮，选择**研发工作台** \> **资产加工** \> **![数据建模](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/7366900161/p208211.png)**，进入数据建模页面。

3.  单击左侧导航栏**场景加工** \> **公共节点** \> **添加节点**。

4.  弹出**添加节点**页面，填写节点名称和code，服务类型选择为“离线服务”、计算资源类型为“MaxCompute”，作业类型为“MR/GRAPH"，单击**下一步**。

    |配置项|说明|
    |---|--|
    |**节点Code**|节点的唯一标识，由用户自定义，同一个工作组必须是唯一的，不可重复。|
    |**节点名称**|节点的名称。|
    |**服务类型**|**服务类型**与**计算资源类型**有内在关联关系。**MaxCompute** 类型的节点需要设置为**离线服务**和 **MaxCompute**。|
    |**计算资源类型**|
    |**作业类型**|包括SQL和MR/GRAPH，选择MR/GRAPH。|
    |**节点描述**|节点的描述性信息，方便用户理解和查找。|
    |**节点类目**|节点的类别，由用户自定义。下拉列表中会显示当前已定义的类目，如果无法满足您的要求，您可单击下拉列表中的**添加新类目**来创建 。|

5.  进入算法资源页面，配置节点资源相关参数，单击**下一步**。

    |配置项|说明|
    |---|--|
    |**脚本内容**|以 SHELL 语言编写启动**节点文件**的脚本。脚本中引用**节点文件**时，必须包含**节点文件**的后缀。|
    |**节点文件**|当**脚本类型**为 **MR/GRAPH** 时，您可以选择以上传的方式，添加脚本内容。上传算法文件时需要配置以下两个参数：     -   **算法文件**：本地编写完成的算法文件。
    -   **保留源文件名**：上传**算法文件**后，是否保留**算法文件**的源文件名。如果设置为**否**，则按规则随机生成算法文件名。 |

6.  配置**节点输入**。

    如果算法文件和脚本中有要求输入变量，则单击**添加输入数据**，配置输入变量。

    |配置项|说明|
    |---|--|
    |**输入变量**|输入数据的名称，用户自定义。|
    |**数据格式**|输入数据的数据格式，由数据模型定义，在下拉列表中选择。|
    |**数据源类型**|输入数据的数据源类型，在下拉列表中选择，可选值与前面设置的**计算资源类型**有关，**MaxCompute** 类型的计算资源支持 **MaxCompute** 类型的输入变量。|

7.  完成**节点输入**配置后，单击**下一步**，配置**节点输出**。

    如果算法文件和脚本中有要求输出变量，则单击**添加输入数据**，配置输出变量。

    |配置项|说明|
    |---|--|
    |**输出变量**|输出变量的名称，用户自定义。|
    |**数据格式**|输出变量的数据格式，由数据模型定义，在下拉列表中选择。|
    |**数据源类型**|输出变量的数据源类型，在下拉列表中选择，可选值与前面设置的**计算资源类型**有关，**MaxCompute** 类型的计算资源支持 **MaxCompute** 类型的输出变量。|

8.  完成**节点输出**配置后，单击**下一步**，配置**节点参数**。

    如果需要设置节点的全局控制参数，则单击**添加参数**，配置节点参数。

    |配置项|说明|
    |---|--|
    |**参数变量**|节点参数的名称，用户自定义。|
    |**值类型**|节点参数的值类型，目前支持的格式包括**STRING**、**BOOLEAN**、**LONG**、**DOUBLE** 和 **DATE**，您可根据实际需要选择。|
    |**必填**|设置**节点参数**在节点的**运行属性**中是否为节点的必填参数。|
    |**默认值**|节点参数的默认值。|
    |**参数说明**|节点参数的描述，方便用户理解。|

9.  完成上述参数配置后，单击**确定**，创建节点完成，在节点管理页面，查看新建的节点。


